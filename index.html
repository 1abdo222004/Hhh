<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>عرض بيانات Telegram WebApp</title>
    <script src="https://telegram.org/js/telegram-web-app.js?2"></script>
    <style>
        body {
            font-family: sans-serif;
            background-color: var(--tg-theme-bg-color, #f0f0f0);
            color: var(--tg-theme-text-color, #333);
            padding: 20px;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
        }
        h1 {
            color: var(--tg-theme-text-color, #000);
        }
        p {
            background-color: var(--tg-theme-secondary-bg-color, #e0e0e0);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            width: 90%;
            max-width: 500px;
            word-wrap: break-word; /* لضمان ظهور النصوص الطويلة */
            text-align: left;
        }
        strong {
            color: var(--tg-theme-link-color, #007bff);
        }
    </style>
</head>
<body>

    <h1>بيانات Telegram WebApp</h1>

    <p><strong>initData:</strong> <span id="initData">جارٍ التحميل...</span></p>
    <p><strong>initDataUnsafe (User ID):</strong> <span id="initDataUnsafeUserId">جارٍ التحميل...</span></p>
    <p><strong>MainButton Visibility:</strong> <span id="mainButtonVisibility">جارٍ التحميل...</span></p>
    <p><strong>Telegram WebApp Version:</strong> <span id="telegramWebAppVersion">جارٍ التحميل...</span></p>
    <p><strong>Color Scheme:</strong> <span id="colorScheme">جارٍ التحميل...</span></p>

    <script type="application/javascript">
        // دالة لضبط سمة الألوان بناءً على Telegram WebApp
        function setThemeClass() {
            document.documentElement.className = Telegram.WebApp.colorScheme;
        }

        // استمع لتغيير سمة الألوان
        Telegram.WebApp.onEvent('themeChanged', setThemeClass);
        setThemeClass(); // اضبط السمة عند التحميل الأولي

        // تهيئة وعرض البيانات عند جاهزية Telegram WebApp
        Telegram.WebApp.ready(function() {
            // عرض initData
            document.getElementById('initData').textContent = Telegram.WebApp.initData || 'لا توجد بيانات';

            // عرض معرف المستخدم (user ID) من initDataUnsafe
            // تأكد من أن initDataUnsafe.user موجود قبل محاولة الوصول إلى id
            if (Telegram.WebApp.initDataUnsafe && Telegram.WebApp.initDataUnsafe.user) {
                document.getElementById('initDataUnsafeUserId').textContent = Telegram.WebApp.initDataUnsafe.user.id || 'غير متاح';
            } else {
                document.getElementById('initDataUnsafeUserId').textContent = 'غير متاح أو غير آمن';
            }


            // عرض حالة زر MainButton
            document.getElementById('mainButtonVisibility').textContent = Telegram.WebApp.MainButton.isVisible ? 'مرئي' : 'غير مرئي';

            // عرض إصدار Telegram WebApp
            document.getElementById('telegramWebAppVersion').textContent = Telegram.WebApp.version || 'غير معروف';

            // عرض نظام الألوان
            document.getElementById('colorScheme').textContent = Telegram.WebApp.colorScheme || 'غير معروف';

            // يمكنك هنا تهيئة أزرار WebApp أو أي منطق آخر
            // For demo purposes, we will just show the main button
            Telegram.WebApp.MainButton.setParams({
                text: 'إغلاق',
                is_visible: true
            }).onClick(function() {
                Telegram.WebApp.close();
            });
        });
    </script>
</body>
</html>
